types:

- name: thinknode_service_id
  doc: ''
  schema:
    enum:
    - iam:
        doc: ''
    - apm:
        doc: ''
    - iss:
        doc: ''
    - calc:
        doc: ''
    - cas:
        doc: ''
    - rks:
        doc: ''
    - immutable:
        doc: ''

- name: thinknode_session
  doc: ''
  schema:
    structure:
    - api_url:
        doc: ''
        schema:
          string: {}
    - access_token:
        doc: ''
        schema:
          string: {}

- name: calculation_request
  doc: ''
  schema:
    union:
    - reference:
        doc: ''
        schema:
          string: {}
    - value:
        doc: ''
        schema:
          dynamic: {}
    - function:
        doc: ''
        schema:
          named:
            app: cradle
            name: function_application
    - array:
        doc: ''
        schema:
          named:
            app: cradle
            name: calculation_array_request
    - item:
        doc: ''
        schema:
          named:
            app: cradle
            name: calculation_item_request
    - object:
        doc: ''
        schema:
          named:
            app: cradle
            name: calculation_object_request
    - property:
        doc: ''
        schema:
          named:
            app: cradle
            name: calculation_property_request
    - let:
        doc: ''
        schema:
          named:
            app: cradle
            name: let_calculation_request
    - variable:
        doc: ''
        schema:
          string: {}
    - meta:
        doc: ''
        schema:
          named:
            app: cradle
            name: meta_calculation_request
    - cast:
        doc: ''
        schema:
          named:
            app: cradle
            name: calculation_cast_request

- name: function_application
  doc: ''
  schema:
    structure:
    - account:
        doc: ''
        schema:
          string: {}
    - app:
        doc: ''
        schema:
          string: {}
    - name:
        doc: ''
        schema:
          string: {}
    - level:
        doc: ''
        schema:
          integer: {}
        omissible: true
    - args:
        doc: ''
        schema:
          array:
            element_schema:
              named:
                app: cradle
                name: calculation_request

- name: calculation_array_request
  doc: ''
  schema:
    structure:
    - items:
        doc: ''
        schema:
          array:
            element_schema:
              named:
                app: cradle
                name: calculation_request
    - item_schema:
        doc: ''
        schema:
          named:
            app: cradle
            name: thinknode_type_info

- name: calculation_object_request
  doc: ''
  schema:
    structure:
    - properties:
        doc: ''
        schema:
          map:
            key_schema:
              string: {}
            value_schema:
              named:
                app: cradle
                name: calculation_request
    - schema:
        doc: ''
        schema:
          named:
            app: cradle
            name: thinknode_type_info

- name: calculation_item_request
  doc: ''
  schema:
    structure:
    - array:
        doc: ''
        schema:
          named:
            app: cradle
            name: calculation_request
    - index:
        doc: ''
        schema:
          named:
            app: cradle
            name: calculation_request
    - schema:
        doc: ''
        schema:
          named:
            app: cradle
            name: thinknode_type_info

- name: calculation_property_request
  doc: ''
  schema:
    structure:
    - object:
        doc: ''
        schema:
          named:
            app: cradle
            name: calculation_request
    - field:
        doc: ''
        schema:
          named:
            app: cradle
            name: calculation_request
    - schema:
        doc: ''
        schema:
          named:
            app: cradle
            name: thinknode_type_info

- name: meta_calculation_request
  doc: ''
  schema:
    structure:
    - generator:
        doc: ''
        schema:
          named:
            app: cradle
            name: calculation_request
    - schema:
        doc: ''
        schema:
          named:
            app: cradle
            name: thinknode_type_info

- name: calculation_cast_request
  doc: ''
  schema:
    structure:
    - schema:
        doc: ''
        schema:
          named:
            app: cradle
            name: thinknode_type_info
    - object:
        doc: ''
        schema:
          named:
            app: cradle
            name: calculation_request

- name: let_calculation_request
  doc: ''
  schema:
    structure:
    - variables:
        doc: ''
        schema:
          map:
            key_schema:
              string: {}
            value_schema:
              named:
                app: cradle
                name: calculation_request
    - in:
        doc: ''
        schema:
          named:
            app: cradle
            name: calculation_request

- name: id_response
  doc: 'This describes an HTTP response with just an ID field.'
  schema:
    structure:
    - id:
        doc: ''
        schema:
          string: {}

- name: reported_calculation_info
  doc: ''
  schema:
    structure:
    - id:
        doc: 'the Thinknode ID of the calculation'
        schema:
          string: {}
    - label:
        doc: 'a label for the calculation - Currently, this is just the function name.'
        schema:
          string: {}

- name: let_calculation_submission_info
  doc: ''
  schema:
    structure:
    - main_calc_id:
        doc: 'the ID of the top-level calculation'
        schema:
          string: {}
    - reported_subcalcs:
        doc: "info on any subcalculations whose progress we're interested in"
        schema:
          array:
            element_schema:
              named:
                app: cradle
                name: reported_calculation_info
    - other_subcalc_ids:
        doc: 'IDs of any other subcalculations'
        schema:
          array:
            element_schema:
              string: {}

- name: augmented_calculation_request
  doc: |
    This augments a normal Thinknode calculation request with extra information
    that's useful for status reporting.
  schema:
    structure:
    - request:
        doc: 'the underlying request'
        schema:
          named:
            app: cradle
            name: calculation_request
    - reported_variables:
        doc: 'any variables that should be reported on'
        schema:
          array:
            element_schema:
              string: {}

- name: calculation_queue_type
  doc: ''
  schema:
    enum:
    - pending:
        doc: ''
    - ready:
        doc: ''

- name: calculation_calculating_status
  doc: ''
  schema:
    structure:
    - progress:
        doc: ''
        schema:
          float: {}

- name: calculation_uploading_status
  doc: ''
  schema:
    structure:
    - progress:
        doc: ''
        schema:
          float: {}

- name: calculation_failure_status
  doc: ''
  schema:
    structure:
    - code:
        doc: ''
        schema:
          string: {}
    - error:
        doc: ''
        schema:
          string: {}
    - message:
        doc: ''
        schema:
          string: {}

- name: calculation_status
  doc: ''
  schema:
    union:
    - calculating:
        doc: ''
        schema:
          named:
            app: cradle
            name: calculation_calculating_status
    - canceled:
        doc: ''
        schema:
          nil: {}
    - completed:
        doc: ''
        schema:
          nil: {}
    - failed:
        doc: ''
        schema:
          named:
            app: cradle
            name: calculation_failure_status
    - generating:
        doc: ''
        schema:
          nil: {}
    - queued:
        doc: ''
        schema:
          named:
            app: cradle
            name: calculation_queue_type
    - uploading:
        doc: ''
        schema:
          named:
            app: cradle
            name: calculation_uploading_status
    - waiting:
        doc: ''
        schema:
          nil: {}

- name: thinknode_type_info
  doc: ''
  schema:
    union:
    - array_type:
        doc: ''
        schema:
          named:
            app: cradle
            name: thinknode_array_info
    - blob_type:
        doc: ''
        schema:
          named:
            app: cradle
            name: thinknode_blob_type
    - boolean_type:
        doc: ''
        schema:
          named:
            app: cradle
            name: thinknode_boolean_type
    - datetime_type:
        doc: ''
        schema:
          named:
            app: cradle
            name: thinknode_datetime_type
    - dynamic_type:
        doc: ''
        schema:
          named:
            app: cradle
            name: thinknode_dynamic_type
    - enum_type:
        doc: ''
        schema:
          named:
            app: cradle
            name: thinknode_enum_info
    - float_type:
        doc: ''
        schema:
          named:
            app: cradle
            name: thinknode_float_type
    - integer_type:
        doc: ''
        schema:
          named:
            app: cradle
            name: thinknode_integer_type
    - map_type:
        doc: ''
        schema:
          named:
            app: cradle
            name: thinknode_map_info
    - named_type:
        doc: ''
        schema:
          named:
            app: cradle
            name: thinknode_named_type_reference
    - nil_type:
        doc: ''
        schema:
          named:
            app: cradle
            name: thinknode_nil_type
    - optional_type:
        doc: ''
        schema:
          named:
            app: cradle
            name: thinknode_type_info
    - reference_type:
        doc: ''
        schema:
          named:
            app: cradle
            name: thinknode_type_info
    - string_type:
        doc: ''
        schema:
          named:
            app: cradle
            name: thinknode_string_type
    - structure_type:
        doc: ''
        schema:
          named:
            app: cradle
            name: thinknode_structure_info
    - union_type:
        doc: ''
        schema:
          named:
            app: cradle
            name: thinknode_union_info

- name: thinknode_nil_type
  doc: ''
  schema:
    structure: []

- name: thinknode_boolean_type
  doc: ''
  schema:
    structure: []

- name: thinknode_integer_type
  doc: ''
  schema:
    structure: []

- name: thinknode_float_type
  doc: ''
  schema:
    structure: []

- name: thinknode_string_type
  doc: ''
  schema:
    structure: []

- name: thinknode_datetime_type
  doc: ''
  schema:
    structure: []

- name: thinknode_blob_type
  doc: ''
  schema:
    structure: []

- name: thinknode_dynamic_type
  doc: ''
  schema:
    structure: []

- name: thinknode_structure_field_info
  doc: ''
  schema:
    structure:
    - description:
        doc: ''
        schema:
          string: {}
    - omissible:
        doc: ''
        omissible: true
        schema:
          boolean: {}
    - schema:
        doc: ''
        schema:
          named:
            app: cradle
            name: thinknode_type_info

- name: thinknode_structure_info
  doc: ''
  schema:
    structure:
    - fields:
        doc: ''
        schema:
          map:
            key_schema:
              string: {}
            value_schema:
              named:
                app: cradle
                name: thinknode_structure_field_info

- name: thinknode_union_member_info
  doc: ''
  schema:
    structure:
    - description:
        doc: ''
        schema:
          string: {}
    - schema:
        doc: ''
        schema:
          named:
            app: cradle
            name: thinknode_type_info

- name: thinknode_union_info
  doc: ''
  schema:
    structure:
    - members:
        doc: ''
        schema:
          map:
            key_schema:
              string: {}
            value_schema:
              named:
                app: cradle
                name: thinknode_union_member_info

- name: thinknode_enum_value_info
  doc: ''
  schema:
    structure:
    - description:
        doc: ''
        schema:
          string: {}

- name: thinknode_enum_info
  doc: ''
  schema:
    structure:
    - values:
        doc: ''
        schema:
          map:
            key_schema:
              string: {}
            value_schema:
              named:
                app: cradle
                name: thinknode_enum_value_info

- name: thinknode_array_info
  doc: ''
  schema:
    structure:
    - element_schema:
        doc: ''
        schema:
          named:
            app: cradle
            name: thinknode_type_info
    - size:
        doc: If size is absent, any size is acceptable.
        omissible: true
        schema:
          integer: {}

- name: thinknode_map_info
  doc: ''
  schema:
    structure:
    - key_schema:
        doc: ''
        schema:
          named:
            app: cradle
            name: thinknode_type_info
    - value_schema:
        doc: ''
        schema:
          named:
            app: cradle
            name: thinknode_type_info

- name: thinknode_named_type_reference
  doc: ''
  schema:
    structure:
    - account:
        doc: ''
        omissible: true
        schema:
          string: {}
    - app:
        doc: ''
        schema:
          string: {}
    - name:
        doc: ''
        schema:
          string: {}

- name: thinknode_function_parameter_info
  doc: ''
  schema:
    structure:
    - name:
        doc: ''
        schema:
          string: {}
    - description:
        doc: ''
        schema:
          string: {}
    - schema:
        doc: ''
        schema:
          named:
            app: cradle
            name: thinknode_type_info

- name: thinknode_function_result_info
  doc: ''
  schema:
    structure:
    - description:
        doc: ''
        schema:
          string: {}
    - schema:
        doc: ''
        schema:
          named:
            app: cradle
            name: thinknode_type_info

- name: thinknode_function_type_info
  doc: ''
  schema:
    structure:
    - parameters:
        doc: ''
        schema:
          array:
            element_schema:
              named:
                app: cradle
                name: thinknode_function_parameter_info
    - returns:
        doc: ''
        schema:
          named:
            app: cradle
            name: thinknode_function_result_info

- name: thinknode_function_type
  doc: ''
  schema:
    union:
    - function_type:
        doc: ''
        schema:
          named:
            app: cradle
            name: thinknode_function_type_info

- name: thinknode_function_info
  doc: ''
  schema:
    structure:
    - name:
        doc: ''
        schema:
          string: {}
    - description:
        doc: ''
        schema:
          string: {}
    - execution_class:
        doc: ''
        schema:
          string: {}
    - schema:
        doc: ''
        schema:
          named:
            app: cradle
            name: thinknode_function_type

- name: thinknode_named_type_info
  doc: ''
  schema:
    structure:
    - name:
        doc: ''
        schema:
          string: {}
    - description:
        doc: ''
        schema:
          string: {}
    - schema:
        doc: ''
        schema:
          named:
            app: cradle
            name: thinknode_type_info

- name: thinknode_provider_image_info
  doc: ''
  schema:
    union:
    - tag:
        doc: "References a docker image by tag."
        schema:
          string: {}
    - digest:
        doc: "References a docker image by digest."
        schema:
          string: {}

- name: thinknode_private_provider_info
  doc: ''
  schema:
    structure:
    - image:
        doc: ''
        schema:
          named:
            app: cradle
            name: thinknode_provider_image_info

- name: thinknode_provider_info
  doc: ''
  schema:
    union:
    - private:
        doc: ''
        schema:
          named:
            app: cradle
            name: thinknode_private_provider_info

- name: thinknode_app_manifest
  doc: ''
  schema:
    structure:
    - dependencies:
        doc: An array of objects that denote the app and version on which the manifest depends.
        schema:
          array:
            element_schema:
              dynamic: {}
    - provider:
        doc: A docker container providing function and upgrade implementations.
        schema:
          named:
            app: cradle
            name: thinknode_provider_info
        omissible: true
    - types:
        doc: An array of types.
        schema:
          array:
            element_schema:
              named:
                app: cradle
                name: thinknode_named_type_info
    - functions:
        doc: An array of functions.
        schema:
          array:
            element_schema:
              named:
                app: cradle
                name: thinknode_function_info
    - records:
        doc: An array of records.
        schema:
          array:
            element_schema:
              dynamic: {}
    - upgrades:
        doc: An array of upgrade functions to use when migrating data from one
          version to another.
        schema:
          array:
            element_schema:
              dynamic: {}

- name: thinknode_app_version_info
  doc: ''
  schema:
    structure:
    - name:
        doc: The name of the version.
        schema:
          string: {}
    - manifest:
        doc: The manifest for the version.
        schema:
          named:
            app: cradle
            name: thinknode_app_manifest
        omissible: true
    - created_by:
        doc: The user that created the version.
        schema:
          dynamic: {}
    - created_at:
        doc: Indicates the date and time when the version was created.
        schema:
          datetime: {}

- name: thinknode_app_source_info
  doc: ''
  schema:
    union:
      - version:
          doc: The name of the source version.
          schema:
            string: {}
      - branch:
          doc: The name of the source branch.
          schema:
            string: {}
      - commit:
          doc: The unique id of the source commit. Note that this is only returned if the associated commit is not the current head of a branch.
          schema:
            string: {}

- name: thinknode_context_app_info
  doc: ''
  schema:
    structure:
      - account:
          doc: The name of the account responsible for publishing the app.
          schema:
            string: {}
      - app:
          doc: The name of the app.
          schema:
            string: {}
      - source:
          doc: ''
          schema:
            named:
              app: cradle
              name: thinknode_app_source_info

- name: thinknode_context_contents
  doc: ''
  schema:
    structure:
      - bucket:
          doc: The bucket for the context.
          schema:
            string: {}
      - contents:
          doc: A list of apps within the context.
          schema:
            array:
              element_schema:
                named:
                  app: cradle
                  name: thinknode_context_app_info

- name: thinknode_supervisor_calculation_request
  doc: ''
  schema:
    structure:
      - name:
          doc: 'the name of the function to invoke'
          schema:
            string: {}
      - args:
          doc: 'the arguments to the function'
          schema:
            array:
              element_schema:
                dynamic: {}

- name: thinknode_supervisor_message
  doc: ''
  schema:
    union:
      - function:
          doc: ''
          schema:
            named:
              app: cradle
              name: thinknode_supervisor_calculation_request
      - ping:
          doc: ''
          schema:
            string: {}

- name: thinknode_provider_progress_update
  doc: ''
  schema:
    structure:
      - value:
          doc: ''
          schema:
            float: {}
      - message:
          doc: ''
          schema:
            string: {}

- name: thinknode_provider_failure
  doc: ''
  schema:
    structure:
      - code:
          doc: ''
          schema:
            string: {}
      - message:
          doc: ''
          schema:
            string: {}

- name: thinknode_provider_registration
  doc: ''
  schema:
    structure:
      - protocol:
          doc: 'protocol version'
          schema:
            integer: {}
      - pid:
          doc: 'unique ID assigned to this provider'
          schema:
            string: {}

- name: thinknode_provider_message
  doc: ''
  schema:
    union:
      - registration:
          doc: ''
          schema:
            named:
              app: cradle
              name: thinknode_provider_registration
      - progress:
          doc: ''
          schema:
            named:
              app: cradle
              name: thinknode_provider_progress_update
      - pong:
          doc: ''
          schema:
            string: {}
      - result:
          doc: ''
          schema:
            dynamic: {}
      - failure:
          doc: ''
          schema:
            named:
              app: cradle
              name: thinknode_provider_failure
